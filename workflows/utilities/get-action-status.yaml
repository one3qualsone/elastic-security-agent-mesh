# =============================================================================
# Workflow: Get Action Status
# Category: utilities
#
# Retrieves the status of an endpoint response action by its action ID.
# Used to check whether a previously initiated command (execute, isolate,
# release) has completed.
#
# Author: Elastic (modified by Security Agent Mesh)
# Created: 2025-12-04
# =============================================================================
name: Get Action Status
description: Check the status of a pending endpoint response action.
enabled: true

tags:
  - agent-mesh
  - utilities
  - response-actions

triggers:
  - type: manual

inputs:
  - name: action_id
    type: string
    description: "The action ID returned by an endpoint response action (execute, isolate, release)"
    required: true

steps:

  - name: get_action_status
    type: http
    with:
      method: GET
      url: "__KIBANA_URL__/s/__KIBANA_SPACE__/api/endpoint/action/{{ inputs.action_id }}"
      headers:
        Authorization: "ApiKey __KIBANA_API_KEY__"
        kbn-xsrf: "true"

  - name: output_status
    type: console
    with:
      message: |
        Action ID: {{ inputs.action_id }}
        Status: {{ steps.get_action_status.output.data.data }}
