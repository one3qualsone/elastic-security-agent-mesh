name: Call Subagent Workflow
description: Invoke a specialist agent via the Agent Builder converse API.
enabled: true

triggers:
  - type: manual

consts:
  connector_id: "__LLM_CONNECTOR_ID__"

inputs:
  - name: agent_id
    type: string
    description: The ID of the agent to invoke
    required: true
  - name: question
    type: string
    description: The question or prompt to send to the subagent
    required: true

steps:

  - name: debug_inputs
    type: console
    with:
      message: "Calling agent_id={{ inputs.agent_id }} with connector={{ consts.connector_id }}"

  - name: converse_with_agent
    type: kibana.post_agent_builder_converse
    with:
      agent-id: "{{ inputs.agent_id }}"
      connector-id: "{{ consts.connector_id }}"
      input: "{{ inputs.question }}"
    timeout: 600s

  - name: filter_output
    type: console
    with:
      message: "{{ steps.converse_with_agent.output.response.message }}"
